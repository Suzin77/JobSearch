{% extends 'base.html.twig' %}

{% block body %}

    
    <canvas id="my" width="800" height= "600"></canvas>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js" integrity="sha256-xKeoJ50pzbUGkpQxDYHD7o7hxe0LaOGeguUidbq6vis=" crossorigin="anonymous"></script>
    
    <script type = "text/javascript" >
    
    var datafeed = {{ data|json_encode|raw }};

    datafeed = JSON.parse(datafeed);
    console.log(datafeed);
    var labelsData = datafeed.map(object => object.publish);
    var dataForCharts = datafeed.map(totalOffers => totalOffers.total_per_day);

    var ctx = document.getElementById('my');
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labelsData,
            datasets: [{
                label: '# of Votes',
                data: dataForCharts,
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive:false,
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
    </script>
     
{% endblock %}